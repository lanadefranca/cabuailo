<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/homeStyle.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js" type="text/javascript"></script>
    <title>Document</title>
    <link rel="icon" href="icone.ico" widht="100%">
</head>
<body>
    <div class="d1">
        <navbar>
                <img src="../imagens/logo.png" width="120px">
                <nav class="navbar">
                    <a href="#">Home</a>
                    <a href="#">Serviços</a>
                    <a href="#">Sobre Nós</a>
                    <a href="#">Seja Parceiro</a>
                    <a href="#">Contato</a>
                    <a href="../html/loginScreen.html">Minha conta</a>
                </nav>
        </navbar>
    </div>
    <div class="d2">
        <header class="--titulo .animated-text" id="header">
            <h1 class="main-title">CABUAILO</h1>
            <p>O sistema ideal para o seu negócio decolar.</p>
            <button onclick="scrollSuave()">
                Saiba mais...
            </button>
        </header>
    </div>

    <!-- seção dois animada com hidden -->
    <!-- section class="hidden" seleciona todos os elementos filho -->
    <div class="sec1">
        <div id="resposta">  </div>
    </div>

    <!-- mudar depois : -->

    <footer>
            <p>Fale conosco: </p>
            <input type="email" placeholder="Seu email">
            <input type="text" placeholder="Sua mensagem" id="mensagem">
            <button onclick="Enviar();">Enviar</button>
    </footer>
</body>
<script>
    //mudar depois: 
    const currentScroll = window.pageYOffset

    if (currentScroll > 1000) {
        header.classList.add('hidden-titulo')
    } else {
        header.classList.remove('hidden-titulo')
    };

    topico = "senai/cabuailo-paulo";  // Variável que ficará no servidor MQTT

    // Conexão:
    client = new Paho.MQTT.Client("broker.hivemq.com", Number(8000), "");

    // Funções executadas quando a conexão é perdida e quando uma mensagem chega:
    client.onConnectionLost = ConexaoPerdida;
    client.onMessageArrived = MensagemRecebida;

    // Função chamada quando a conexão for realizada:
    client.connect({onSuccess:Conectar});

    // A função Conectar deve criar a variável (tópico) no computador remoto:
    function Conectar() {
    
        client.subscribe(topico);  // Tópico (variável) criado no servidor MQTT
    
    }

    function ConexaoPerdida(responseObject) {
    if (responseObject.errorCode !== 0) {
        resposta.innerHTML += "Desconectado";
    }
    }

    // Função executada quando a variável (tópico) no servidor receber uma mensagem:
    function MensagemRecebida(message) {
        resposta.innerHTML += "<br><br>" + message.payloadString;
    }

    function Enviar()
    {
        texto = mensagem.value;
        console.log(texto);
        message = new Paho.MQTT.Message(texto);
        message.destinationName = topico;
        client.send(message);
    }
</script>
<script src="../js/sBar.js"></script>
<script src="../js/scrollAnimation.js"></script>
</html>